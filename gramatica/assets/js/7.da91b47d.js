(window.webpackJsonp=window.webpackJsonp||[]).push([[7],{308:function(e,t,s){"use strict";s.r(t);s(90);const n=new(s(0).a)({data:{eventQueue:[]},methods:{emit(e,...t){this._events&&this._events[e]?this.$emit(e,...t):this.eventQueue.push({event:e,args:t})},on(e,t){this.$on(e,t),this.eventQueue=this.eventQueue.filter(t=>t.event!==e||(this.$emit(e,...t.args),!1))}}});var o={data:()=>({pyodideReady:!1,evBus:n,basePath:"/nhe-enga/gramatica/",elems:[]}),methods:{getAllPyComponents:()=>Array.from(document.querySelectorAll(".python-output")),getCurrentComponentIndex(e){return this.getAllPyComponents().indexOf(e)},countComponents(){return this.getAllPyComponents().length},receiveMessage(e){e.data.pyodideReady&&(console.log("pyodide ready!"),this.pyodideReady=!0,console.log("comps: "+this.countComponents()),this.updateContent())},sendMessagesToIframe(){for(let e of this.messages)this.$refs.pyodideiframe.contentWindow.postMessage(e.command,"*")},updateContent(e){console.log("updating");let t=this.getAllPyComponents().map(e=>e.__vue__);for(let e=0;e<t.length;e++){let s={command:"processBlock",orderid:e,hash:t[e].hash,html:t[e].origText};this.$refs.pyodideiframe.contentWindow.postMessage(s,"*")}e&&(this.elems=[])}},mounted(){this.evBus.$on("pyReadyRender",(e,t)=>{this.getAllPyComponents().includes(e.$el)||(this.elems=[]);let s=this.countComponents();console.log("EMITED: "+e.origText,s,t),this.elems.push(e),this.pyodideReady&&this.elems.length>=s&&this.updateContent(!0)}),window.addEventListener("message",this.receiveMessage)},beforeDestroy(){window.removeEventListener("message",this.receiveMessage)}},i=s(15),a=Object(i.a)(o,(function(){var e=this._self._c;return e("div",[e("iframe",{ref:"pyodideiframe",staticStyle:{display:"none"},attrs:{id:"pyodide-iframe",src:this.basePath+"iframe_pyodide.html"}})])}),[],!1,null,null,null);t.default=a.exports}}]);